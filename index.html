<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>DANGER MODS – Key Generator</title>

<style>
  :root{
    --muted: #9aa7b2;
    font-family: Arial, sans-serif;
  }

  body{
    margin:0;
    background:#000;
    color:#e6f0f2;
    overflow:hidden;
  }

  .wrap{
    min-height:100vh;
    display:flex;
    justify(content):center;
    align-items:center;
    padding:20px;
    position:relative;
    z-index:10;
  }

  .card{
    width:100%;
    max-width:420px;
    background:rgba(255,255,255,0.05);
    padding:28px;
    border-radius:14px;
    border:1px solid rgba(255,255,255,0.08);
    backdrop-filter: blur(6px);
  }

  .logo{
    width:100px;
    height:100px;
    border-radius:50%;
    overflow:hidden;
    margin:0 auto 15px;
    background:#111;
    display:flex;
    justify-content:center;
    align-items:center;
  }

  .logo img{
    width:100%;
    height:100%;
    object-fit:cover;
    display:block;
  }

  h1{
    text-align:center;
    margin:0 0 18px;
    color: #00ff9d;
    letter-spacing: 2px;
  }

  label{
    display:block;
    font-size:13px;
    color:var(--muted);
    margin-bottom:5px;
  }

  select{
    width:100%;
    padding:10px;
    border-radius:10px;
    border:1px solid rgba(255,255,255,0.1);
    background:rgba(0,0,0,0.5);
    color:white;
    font-size:15px;
    outline: none;
  }

  .keyBox{
    background:rgba(0, 255, 157, 0.05);
    border:1px solid rgba(0, 255, 157, 0.2);
    padding:12px;
    border-radius:10px;
    font-family:monospace;
    min-height:45px;
    text-align:center;
    display:flex;
    justify-content:center;
    align-items:center;
    margin-top:12px;
    color: #00ff9d;
    font-weight: bold;
    word-break: break-all;
  }

  .btn{
    width:100%;
    padding:12px;
    margin-top:12px;
    background:#0ea5a4;
    border-radius:10px;
    border:none;
    cursor:pointer;
    font-weight:bold;
    font-size:16px;
    color: white;
    transition: 0.3s;
  }

  .btn:hover{ background: #12c9c6; }

  .btn.secondary{
    background:transparent;
    border:1px solid #5eead4;
    color:#5eead4;
  }

  .btn.secondary:hover{ background: rgba(94, 234, 212, 0.1); }

  .toast{
    position:fixed;
    left:50%;
    transform:translateX(-50%);
    bottom:30px;
    background:rgba(0, 255, 157, 0.2);
    border: 1px solid #00ff9d;
    color: white;
    padding:10px 14px;
    border-radius:10px;
    opacity:0;
    transition:0.25s;
    z-index:99;
  }

  .toast.show{ opacity:1; bottom:45px; }
</style>
</head>
<body>

<canvas id="hackerParticles" style="position:fixed;top:0;left:0;width:100%;height:100%;z-index:0;"></canvas>

<div class="wrap">
  <div class="card">
    <div class="logo">
      <img src="https://i.supaimg.com/c9488a28-6ddb-463b-8ba2-e2c0f117c8f0.png" alt="Logo">
    </div>

    <h1>DANGER MODS</h1>

    <label for="days">Validity Period</label>
    <select id="days">
      <option value="1">1 Day</option>
      <option value="3">3 Days</option>
      <option value="7" selected>7 Days</option>
      <option value="30">30 Days</option>
      <option value="LT">Lifetime</option>
    </select>

    <br><br>

    <label for="device">Device Limit</label>
    <select id="device">
      <option value="1DEV">1 Device</option>
      <option value="2DEV">2 Devices</option>
      <option value="UNLIM">Unlimited</option>
    </select>

    <div class="keyBox" id="keyDisplay">— IDLE —</div>

    <button id="generateBtn" class="btn">Generate & Register Key</button>
    <button id="copyBtn" class="btn secondary">Copy Key</button>
    <button id="telegramBtn" class="btn secondary">Join Telegram</button>

  </div>
</div>

<div id="toast" class="toast">Key Copied!</div>

<script>
/* 1. KEY GENERATION LOGIC */
function secureRandom(len){
  const chars = "ABCDEFGHJKMNPQRSTUVWXYZ23456789";
  const arr = new Uint8Array(len);
  crypto.getRandomValues(arr);
  return [...arr].map(n=>chars[n%chars.length]).join('');
}

function makeKey(){
  const days = document.getElementById("days").value;
  const dev = document.getElementById("device").value;
  const dayPrefix = days === "LT" ? "LT" : days + "D";

  return (
    "DM-" + dayPrefix + "-" + dev + "-" + secureRandom(8)
  );
}

/* 2. API SYNC LOGIC */
document.getElementById("generateBtn").onclick = async () => {
  const btn = document.getElementById("generateBtn");
  const display = document.getElementById("keyDisplay");
  
  const newKey = makeKey();
  
  // Visual Feedback
  display.textContent = "REGISTERING...";
  btn.disabled = true;
  btn.style.opacity = "0.5";

  try {
    // This sends the key to your Netlify Function to "save" it
    const response = await fetch(`/.netlify/functions/api?newKey=${newKey}`);
    const data = await response.json();

    if (data.status === "Registered") {
        display.textContent = newKey;
        showToast("Key Active & Ready!");
    } else {
        display.textContent = "SERVER ERROR";
    }
  } catch (error) {
    console.error(error);
    display.textContent = "OFFLINE MODE";
  } finally {
    btn.disabled = false;
    btn.style.opacity = "1";
  }
};

/* 3. UTILITIES */
function showToast(msg) {
  const t = document.getElementById("toast");
  t.textContent = msg;
  t.classList.add("show");
  setTimeout(()=>t.classList.remove("show"), 2000);
}

document.getElementById("copyBtn").onclick = async () => {
  const key = document.getElementById("keyDisplay").textContent;
  if(key.includes("—")) return;
  await navigator.clipboard.writeText(key);
  showToast("Copied to Clipboard!");
};

document.getElementById("telegramBtn").onclick = () => {
  window.open("https://t.me/+L7c0XyJ-14o5MGQ9", "_blank");
};

/* 4. BACKGROUND ANIMATION */
const canvas = document.getElementById("hackerParticles");
const ctx = canvas.getContext("2d");
function resize(){ canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
resize();
window.onresize = resize;

let particles = [];
for(let i = 0; i < 80; i++){
  particles.push({
    x: Math.random() * canvas.width,
    y: Math.random() * canvas.height,
    speedX: (Math.random() - 0.5) * 0.4,
    speedY: (Math.random() - 0.5) * 0.4,
    size: Math.random() * 2 + 0.5
  });
}

function draw(){
  ctx.fillStyle = "rgba(0, 0, 0, 0.2)";
  ctx.fillRect(0,0,canvas.width,canvas.height);
  ctx.fillStyle = "#00ff9d";
  particles.forEach(p=>{
    ctx.beginPath();
    ctx.arc(p.x,p.y,p.size,0,Math.PI*2);
    ctx.fill();
    p.x += p.speedX; p.y += p.speedY;
    if(p.x < 0 || p.x > canvas.width) p.x = Math.random() * canvas.width;
    if(p.y < 0 || p.y > canvas.height) p.y = Math.random() * canvas.height;
  });
  requestAnimationFrame(draw);
}
draw();
</script>

</body>
                                                  </html>
